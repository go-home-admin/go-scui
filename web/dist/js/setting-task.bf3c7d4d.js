"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[2798,1200],{44715:function(e,t,l){l.r(t),l.d(t,{default:function(){return x}});var o=l(58222);const n=e=>((0,o.pushScopeId)("data-v-dbf89736"),e=e(),(0,o.popScopeId)(),e),a=n((()=>(0,o.createElementVNode)("h4",null,"执行类",-1))),i=n((()=>(0,o.createElementVNode)("h4",null,"定时规则",-1))),d={class:"bottom"},r={class:"state"},s=(0,o.createTextVNode)("准备就绪"),c=(0,o.createTextVNode)("停用"),u={class:"handler"},m=(0,o.createTextVNode)("编辑"),p=(0,o.createTextVNode)("日志"),h=(0,o.createTextVNode)("删除"),C=n((()=>(0,o.createElementVNode)("p",null,"添加计划任务",-1)));function V(e,t,l,n,V,f){const g=(0,o.resolveComponent)("el-tag"),v=(0,o.resolveComponent)("el-button"),N=(0,o.resolveComponent)("el-popconfirm"),k=(0,o.resolveComponent)("el-dropdown-item"),x=(0,o.resolveComponent)("el-dropdown-menu"),w=(0,o.resolveComponent)("el-dropdown"),_=(0,o.resolveComponent)("el-card"),E=(0,o.resolveComponent)("el-col"),y=(0,o.resolveComponent)("el-icon-plus"),B=(0,o.resolveComponent)("el-icon"),b=(0,o.resolveComponent)("el-row"),D=(0,o.resolveComponent)("el-main"),S=(0,o.resolveComponent)("save-dialog"),T=(0,o.resolveComponent)("logs"),$=(0,o.resolveComponent)("el-drawer");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(D,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{gutter:15},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(V.list,(e=>((0,o.openBlock)(),(0,o.createBlock)(E,{xl:6,lg:6,md:8,sm:12,xs:24,key:e.id},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{class:"task task-item",shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("h2",null,(0,o.toDisplayString)(e.title),1),(0,o.createElementVNode)("ul",null,[(0,o.createElementVNode)("li",null,[a,(0,o.createElementVNode)("p",null,(0,o.toDisplayString)(e.handler),1)]),(0,o.createElementVNode)("li",null,[i,(0,o.createElementVNode)("p",null,(0,o.toDisplayString)(e.cron),1)])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",r,["1"==e.state?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,size:"small"},{default:(0,o.withCtx)((()=>[s])),_:1})):(0,o.createCommentVNode)("",!0),"-1"==e.state?((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,size:"small",type:"info"},{default:(0,o.withCtx)((()=>[c])),_:1})):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("div",u,[(0,o.createVNode)(N,{title:"确定立即执行吗？",onConfirm:t=>f.run(e)},{reference:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{type:"primary",icon:"el-icon-caret-right",circle:""})])),_:2},1032,["onConfirm"]),(0,o.createVNode)(w,{trigger:"click"},{dropdown:(0,o.withCtx)((()=>[(0,o.createVNode)(x,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{onClick:t=>f.edit(e)},{default:(0,o.withCtx)((()=>[m])),_:2},1032,["onClick"]),(0,o.createVNode)(k,{onClick:t=>f.logs(e)},{default:(0,o.withCtx)((()=>[p])),_:2},1032,["onClick"]),(0,o.createVNode)(k,{onClick:t=>f.del(e),divided:""},{default:(0,o.withCtx)((()=>[h])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{type:"primary",icon:"el-icon-more",circle:"",plain:""})])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)),(0,o.createVNode)(E,{xl:6,lg:6,md:8,sm:12,xs:24},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{class:"task task-add",shadow:"never",onClick:f.add},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y)])),_:1}),C])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),V.dialog.save?((0,o.openBlock)(),(0,o.createBlock)(S,{key:0,ref:"saveDialog",onSuccess:f.handleSuccess,onClosed:t[0]||(t[0]=e=>V.dialog.save=!1)},null,8,["onSuccess"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)($,{title:"计划任务日志",modelValue:V.dialog.logsVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>V.dialog.logsVisible=e),size:600,direction:"rtl","destroy-on-close":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T)])),_:1},8,["modelValue"])],64)}var f=l(56374),g=l(31027),v={name:"task",components:{saveDialog:f["default"],logs:g["default"]},provide(){return{list:this.list}},data(){return{dialog:{save:!1,logsVisible:!1},list:[{id:"1",title:"清理服务器缓存",handler:"cleanUpCacheHandler",cron:"59 59 23 * * ? *",state:"1"},{id:"2",title:"自动审核",handler:"automaticAuditHandler",cron:"0 0 * * * ? *",state:"1"},{id:"3",title:"清理未实名用户",handler:"deleteUserHandler",cron:"0 0 0 * * ? *",state:"-1"}]}},mounted(){},methods:{add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},del(e){this.$confirm(`确认删除 ${e.title} 计划任务吗？`,"提示",{type:"warning",confirmButtonText:"删除",confirmButtonClass:"el-button--danger"}).then((()=>{this.list.splice(this.list.findIndex((t=>t.id===e.id)),1)})).catch((()=>{}))},logs(){this.dialog.logsVisible=!0},run(e){this.$message.success(`已成功执行计划任务：${e.title}`)},handleSuccess(e,t){"add"==t?(e.id=(new Date).getTime(),this.list.push(e)):"edit"==t&&this.list.filter((t=>t.id===e.id)).forEach((t=>{Object.assign(t,e)}))}}},N=l(83744);const k=(0,N.Z)(v,[["render",V],["__scopeId","data-v-dbf89736"]]);var x=k}}]);