"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[2912],{6586:function(e,t,o){o.r(t),o.d(t,{default:function(){return re}});var l=o(58222);const a=(0,l.createTextVNode)("导入(全配置)"),r=(0,l.createElementVNode)("div",{class:"el-upload__text"},[(0,l.createTextVNode)(" 将文件拖到此处或 "),(0,l.createElementVNode)("em",null,"点击选择文件上传")],-1),i=(0,l.createTextVNode)("Object 文件上传接口对象"),n=(0,l.createTextVNode)("Object 上传时附带的额外参数"),d=(0,l.createTextVNode)('String 可选择文件类型，默认为".xls, .xlsx"'),c=(0,l.createTextVNode)("Number 可选择文件大小，单位为M，默认为10"),s=(0,l.createTextVNode)('String 上传框底下的提示语句，默认为"请上传小于或等于 {maxSize}M 的 {accept} 格式文件"'),p=(0,l.createTextVNode)("String 模板的下载URL"),m=(0,l.createTextVNode)("事件 上传接口返回的事件，返回function(res, close)，执行close()将关闭窗口"),u=(0,l.createTextVNode)("插糟 默认触发按钮插糟，返回open()打开窗口函数，可以绑定元素@click事件"),h=(0,l.createTextVNode)("插糟 自定义上传框插槽"),f=(0,l.createTextVNode)("插糟 自定义表单组件，插槽formData都将作为上传时附带的额外参数"),x=(0,l.createTextVNode)("导出(异步)"),V=(0,l.createTextVNode)("导出(blob文件流)"),N=(0,l.createTextVNode)("Object 文件导出接口对象，通过apiObj.url请求文件"),C=(0,l.createTextVNode)("Object 上传时附带的额外参数(可为数据表格的过滤项)"),w=(0,l.createTextVNode)("Boolean 是否显示附带的额外参数"),b=(0,l.createTextVNode)("Boolean 是否异步导出文件"),g=(0,l.createTextVNode)("String 下载文件名称，默认为当前时间戳"),y=(0,l.createTextVNode)("Array 可选择文件类型，默认为['xlsx']，组件将数组第一项当做已选项"),v=(0,l.createTextVNode)('Array 列配置，请求文件时将添加column为key的参数，值为prop逗号","分割的字符串'),k=(0,l.createTextVNode)("Boolean 是否由游览器请求文件返回blob后提供下载"),_=(0,l.createTextVNode)("Boolean blob开启后是否显示下载文件进度条，当服务器启用Gzip时，建议关闭，因为获取到的文件总数和下载总数不匹配。"),D=(0,l.createTextVNode)("插糟 默认触发按钮插糟，返回open()打开窗口函数，可以绑定元素@click事件"),T=(0,l.createTextVNode)("插糟 自定义表单组件，插槽formData都将作为请求时附带的额外参数"),B={style:{"margin-top":"15px"}},S=(0,l.createTextVNode)(" 失败"),E=(0,l.createTextVNode)("我知道了");function j(e,t,o,j,O,$){const U=(0,l.resolveComponent)("sc-file-import"),L=(0,l.resolveComponent)("el-button"),z=(0,l.resolveComponent)("sc-icon-file-excel"),F=(0,l.resolveComponent)("el-icon"),P=(0,l.resolveComponent)("el-switch"),I=(0,l.resolveComponent)("el-form-item"),A=(0,l.resolveComponent)("el-descriptions-item"),M=(0,l.resolveComponent)("el-descriptions"),R=(0,l.resolveComponent)("el-card"),q=(0,l.resolveComponent)("el-col"),Z=(0,l.resolveComponent)("sc-file-export"),J=(0,l.resolveComponent)("el-option"),Q=(0,l.resolveComponent)("el-select"),G=(0,l.resolveComponent)("el-row"),H=(0,l.resolveComponent)("el-main"),K=(0,l.resolveComponent)("el-alert"),W=(0,l.resolveComponent)("el-table-column"),X=(0,l.resolveComponent)("el-icon-circle-close-filled"),Y=(0,l.resolveComponent)("el-tag"),ee=(0,l.resolveComponent)("el-table"),te=(0,l.resolveComponent)("el-dialog");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createVNode)(H,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(G,{gutter:15},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(q,{lg:12},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{shadow:"never",header:"导入(使用mock,有50%几率导入失败)"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(U,{apiObj:e.$API.common.importFile,templateUrl:"http://www.scuiadmin/file.xlsx",onSuccess:$.success},null,8,["apiObj","onSuccess"]),(0,l.createVNode)(U,{apiObj:e.$API.common.importFile,data:{otherData:"demo"},templateUrl:"http://www.scuiadmin/file.xlsx",accept:".xls, .xlsx",maxSize:30,tip:"请上传小于或等于 30M 的 .xls, .xlsx 格式文件(自定义TIP)",onSuccess:$.success},{default:(0,l.withCtx)((({open:e})=>[(0,l.createVNode)(L,{type:"primary",icon:"sc-icon-upload",onClick:e},{default:(0,l.withCtx)((()=>[a])),_:2},1032,["onClick"])])),uploader:(0,l.withCtx)((()=>[(0,l.createVNode)(F,{class:"el-icon--upload"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(z)])),_:1}),r])),form:(0,l.withCtx)((({formData:e})=>[(0,l.createVNode)(I,{label:"覆盖已有数据"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(P,{modelValue:e.coverage,"onUpdate:modelValue":t=>e.coverage=t},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.createVNode)(I,{label:"跳过错误数据"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(P,{modelValue:e.skipError,"onUpdate:modelValue":t=>e.skipError=t},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1},8,["apiObj","onSuccess"]),(0,l.createVNode)(M,{column:1,border:"",size:"small",style:{"margin-top":"15px"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(A,{label:"apiObj",width:200},{default:(0,l.withCtx)((()=>[i])),_:1}),(0,l.createVNode)(A,{label:"data"},{default:(0,l.withCtx)((()=>[n])),_:1}),(0,l.createVNode)(A,{label:"accept"},{default:(0,l.withCtx)((()=>[d])),_:1}),(0,l.createVNode)(A,{label:"maxSize"},{default:(0,l.withCtx)((()=>[c])),_:1}),(0,l.createVNode)(A,{label:"tip"},{default:(0,l.withCtx)((()=>[s])),_:1}),(0,l.createVNode)(A,{label:"templateUrl"},{default:(0,l.withCtx)((()=>[p])),_:1}),(0,l.createVNode)(A,{label:"@success"},{default:(0,l.withCtx)((()=>[m])),_:1}),(0,l.createVNode)(A,{label:'#default="{open}"'},{default:(0,l.withCtx)((()=>[u])),_:1}),(0,l.createVNode)(A,{label:"#uploader"},{default:(0,l.withCtx)((()=>[h])),_:1}),(0,l.createVNode)(A,{label:'#form="{formData}"'},{default:(0,l.withCtx)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.createVNode)(q,{lg:12},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{shadow:"never",header:"导出"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(Z,{apiObj:e.$API.common.exportFile},null,8,["apiObj"]),(0,l.createVNode)(Z,{apiObj:e.$API.common.exportFile,fileName:"人员列表(异步)",async:""},{default:(0,l.withCtx)((({open:e})=>[(0,l.createVNode)(L,{type:"primary",icon:"sc-icon-download",onClick:e},{default:(0,l.withCtx)((()=>[x])),_:2},1032,["onClick"])])),_:1},8,["apiObj"]),(0,l.createVNode)(Z,{apiObj:e.$API.common.exportFile,blob:"",fileName:"人员列表",data:{otherData:"demo"},showData:"",column:O.column,fileTypes:["xlsx","docx","pdf"]},{default:(0,l.withCtx)((({open:e})=>[(0,l.createVNode)(L,{type:"primary",icon:"sc-icon-download",onClick:e},{default:(0,l.withCtx)((()=>[V])),_:2},1032,["onClick"])])),form:(0,l.withCtx)((({formData:e})=>[(0,l.createVNode)(I,{label:"导出条数"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(Q,{modelValue:e.limit,"onUpdate:modelValue":t=>e.limit=t,placeholder:"Select"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(J,{label:"100条",value:"100"}),(0,l.createVNode)(J,{label:"500条",value:"500"}),(0,l.createVNode)(J,{label:"1000条",value:"1000"}),(0,l.createVNode)(J,{label:"5000条",value:"5000"}),(0,l.createVNode)(J,{label:"10000条",value:"10000"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1},8,["apiObj","column"]),(0,l.createVNode)(M,{column:1,border:"",size:"small",style:{"margin-top":"15px"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(A,{label:"apiObj",width:200},{default:(0,l.withCtx)((()=>[N])),_:1}),(0,l.createVNode)(A,{label:"data"},{default:(0,l.withCtx)((()=>[C])),_:1}),(0,l.createVNode)(A,{label:"showData"},{default:(0,l.withCtx)((()=>[w])),_:1}),(0,l.createVNode)(A,{label:"async"},{default:(0,l.withCtx)((()=>[b])),_:1}),(0,l.createVNode)(A,{label:"fileName"},{default:(0,l.withCtx)((()=>[g])),_:1}),(0,l.createVNode)(A,{label:"fileTypes"},{default:(0,l.withCtx)((()=>[y])),_:1}),(0,l.createVNode)(A,{label:"column"},{default:(0,l.withCtx)((()=>[v])),_:1}),(0,l.createVNode)(A,{label:"blob"},{default:(0,l.withCtx)((()=>[k])),_:1}),(0,l.createVNode)(A,{label:"progress"},{default:(0,l.withCtx)((()=>[_])),_:1}),(0,l.createVNode)(A,{label:'#default="{open}"'},{default:(0,l.withCtx)((()=>[D])),_:1}),(0,l.createVNode)(A,{label:'#form="{formData}"'},{default:(0,l.withCtx)((()=>[T])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.createVNode)(te,{modelValue:O.importErrDialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>O.importErrDialogVisible=e),title:"导入失败",width:680,"destroy-on-close":"",onClosed:t[2]||(t[2]=()=>{O.importErrData={}})},{footer:(0,l.withCtx)((()=>[(0,l.createVNode)(L,{type:"primary",onClick:t[0]||(t[0]=e=>O.importErrDialogVisible=!1)},{default:(0,l.withCtx)((()=>[E])),_:1})])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(K,{title:`总条目数 ${O.importErrData.ok} ,其中有 ${O.importErrData.fail} 条格式不满足导入要求，请修改后再次操作。`,type:"error","show-icon":"",closable:!1},null,8,["title"]),(0,l.createElementVNode)("div",B,[(0,l.createVNode)(ee,{data:O.importErrData.failList,border:"",stripe:"","max-height":"270",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(W,{prop:"keyName",label:"主键名",width:"180"}),(0,l.createVNode)(W,{prop:"",label:"状态",width:"100"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(Y,{type:"danger"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(F,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(X)])),_:1}),S])),_:1})])),_:1}),(0,l.createVNode)(W,{prop:"reason",label:"原因"})])),_:1},8,["data"])])])),_:1},8,["modelValue"])],64)}const O=(0,l.createTextVNode)("导入"),$=(0,l.createElementVNode)("div",{class:"el-upload__text"},[(0,l.createTextVNode)(" 将文件拖到此处或 "),(0,l.createElementVNode)("em",null,"点击选择文件上传")],-1),U={class:"el-upload__tip"},L={key:2,style:{"margin-top":"7px"}},z=(0,l.createTextVNode)("下载导入模板");function F(e,t,o,a,r,i){const n=(0,l.resolveComponent)("el-button"),d=(0,l.resolveComponent)("el-progress"),c=(0,l.resolveComponent)("el-icon-upload-filled"),s=(0,l.resolveComponent)("el-icon"),p=(0,l.resolveComponent)("el-link"),m=(0,l.resolveComponent)("el-upload"),u=(0,l.resolveComponent)("el-form"),h=(0,l.resolveComponent)("el-dialog"),f=(0,l.resolveDirective)("loading");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.renderSlot)(e.$slots,"default",{open:i.open},(()=>[(0,l.createVNode)(n,{type:"primary",plain:"",onClick:i.open},{default:(0,l.withCtx)((()=>[O])),_:1},8,["onClick"])])),(0,l.createVNode)(h,{modelValue:r.dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>r.dialog=e),title:"导入",width:550,"close-on-click-modal":!1,"append-to-body":"","destroy-on-close":""},{default:(0,l.withCtx)((()=>[r.loading?((0,l.openBlock)(),(0,l.createBlock)(d,{key:0,"text-inside":!0,"stroke-width":20,percentage:r.percentage,style:{"margin-bottom":"15px"}},null,8,["percentage"])):(0,l.createCommentVNode)("",!0),(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createVNode)(m,{ref:"uploader",drag:"",accept:o.accept,maxSize:o.maxSize,limit:1,data:o.data,"show-file-list":!1,"http-request":i.request,"before-upload":i.before,"on-progress":i.progress,"on-success":i.success,"on-error":i.error},{tip:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",U,[o.tip?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createTextVNode)((0,l.toDisplayString)(o.tip),1)],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createTextVNode)("请上传小于或等于 "+(0,l.toDisplayString)(o.maxSize)+"M 的 "+(0,l.toDisplayString)(o.accept)+" 格式文件",1)],64)),o.templateUrl?((0,l.openBlock)(),(0,l.createElementBlock)("p",L,[(0,l.createVNode)(p,{href:o.templateUrl,target:"_blank",type:"primary",underline:!1},{default:(0,l.withCtx)((()=>[z])),_:1},8,["href"])])):(0,l.createCommentVNode)("",!0)])])),default:(0,l.withCtx)((()=>[(0,l.renderSlot)(e.$slots,"uploader",{},(()=>[(0,l.createVNode)(s,{class:"el-icon--upload"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c)])),_:1}),$]))])),_:3},8,["accept","maxSize","data","http-request","before-upload","on-progress","on-success","on-error"]),e.$slots.form?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,inline:"","label-width":"100px","label-position":"left",style:{"margin-top":"18px"}},{default:(0,l.withCtx)((()=>[(0,l.renderSlot)(e.$slots,"form",{formData:r.formData})])),_:3})):(0,l.createCommentVNode)("",!0)])),[[f,r.loading]])])),_:3},8,["modelValue"])],64)}var P={emits:["success"],props:{apiObj:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},accept:{type:String,default:".xls, .xlsx"},maxSize:{type:Number,default:10},tip:{type:String,default:""},templateUrl:{type:String,default:""}},data(){return{dialog:!1,loading:!1,percentage:0,formData:{}}},mounted(){},methods:{open(){this.dialog=!0,this.formData={}},close(){this.dialog=!1},before(e){const t=e.size/1024/1024<this.maxSize;if(!t)return this.$message.warning(`上传文件大小不能超过 ${this.maxSize}MB!`),!1;this.loading=!0},progress(e){this.percentage=e.percent},success(e,t){this.$refs.uploader.handleRemove(t),this.$refs.uploader.clearFiles(),this.loading=!1,this.percentage=0,this.$emit("success",e,this.close)},error(e){this.loading=!1,this.percentage=0,this.$notify.error({title:"上传文件未成功",message:e})},request(e){Object.assign(e.data,this.formData);const t=new FormData;t.append(e.filename,e.file);for(const o in e.data)t.append(o,e.data[o]);this.apiObj.post(t,{onUploadProgress:t=>{const o=parseInt(t.loaded/t.total*100|0,10);e.onProgress({percent:o})}}).then((t=>{e.onSuccess(t)})).catch((t=>{e.onError(t)}))}}},I=o(83744);const A=(0,I.Z)(P,[["render",F]]);var M=A;const R=(0,l.createTextVNode)("导出"),q={"element-loading-text":"正在处理中..."},Z={key:0,style:{position:"absolute",width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","z-index":"3000"}},J=(0,l.createTextVNode)("发起导出任务"),Q=(0,l.createTextVNode)("下 载");function G(e,t,o,a,r,i){const n=(0,l.resolveComponent)("el-button"),d=(0,l.resolveComponent)("el-progress"),c=(0,l.resolveComponent)("el-input"),s=(0,l.resolveComponent)("el-form-item"),p=(0,l.resolveComponent)("el-option"),m=(0,l.resolveComponent)("el-select"),u=(0,l.resolveComponent)("el-form"),h=(0,l.resolveComponent)("el-tab-pane"),f=(0,l.resolveComponent)("columnSet"),x=(0,l.resolveComponent)("el-descriptions-item"),V=(0,l.resolveComponent)("el-descriptions"),N=(0,l.resolveComponent)("el-tabs"),C=(0,l.resolveComponent)("el-main"),w=(0,l.resolveComponent)("el-drawer"),b=(0,l.resolveDirective)("loading");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.renderSlot)(e.$slots,"default",{open:i.open},(()=>[(0,l.createVNode)(n,{type:"primary",plain:"",onClick:i.open},{default:(0,l.withCtx)((()=>[R])),_:1},8,["onClick"])])),(0,l.createVNode)(w,{modelValue:r.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>r.dialog=e),title:"导出",size:400,direction:"rtl","append-to-body":"","destroy-on-close":""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(C,{style:{padding:"0 20px 20px 20px"}},{default:(0,l.withCtx)((()=>[(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)("div",q,[r.downLoading&&o.progress?((0,l.openBlock)(),(0,l.createElementBlock)("div",Z,[(0,l.createVNode)(d,{"text-inside":!0,"stroke-width":20,percentage:r.downLoadProgress,style:{width:"100%","margin-bottom":"120px"}},null,8,["percentage"])])):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(N,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{label:"常规",lazy:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{"label-width":"100px","label-position":"left",style:{margin:"10px 0 20px 0"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{label:"文件名"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{modelValue:r.formData.fileName,"onUpdate:modelValue":t[0]||(t[0]=e=>r.formData.fileName=e),placeholder:"请输入文件名"},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(s,{label:"文件类型"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(m,{modelValue:r.formData.fileType,"onUpdate:modelValue":t[1]||(t[1]=e=>r.formData.fileType=e),placeholder:"请选择文件类型"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.fileTypes,(e=>((0,l.openBlock)(),(0,l.createBlock)(p,{key:e,label:"*."+e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.renderSlot)(e.$slots,"form",{formData:r.formData})])),_:3}),o.async?((0,l.openBlock)(),(0,l.createBlock)(n,{key:0,type:"primary",size:"large",icon:"el-icon-plus",style:{width:"100%"},onClick:i.download,loading:r.asyncLoading},{default:(0,l.withCtx)((()=>[J])),_:1},8,["onClick","loading"])):((0,l.openBlock)(),(0,l.createBlock)(n,{key:1,type:"primary",size:"large",icon:"el-icon-download",style:{width:"100%"},onClick:i.download},{default:(0,l.withCtx)((()=>[Q])),_:1},8,["onClick"]))])),_:3}),r.columnData.length>0?((0,l.openBlock)(),(0,l.createBlock)(h,{key:0,label:"列设置",lazy:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(f,{column:r.columnData},null,8,["column"])])),_:1})):(0,l.createCommentVNode)("",!0),o.data&&o.showData?((0,l.openBlock)(),(0,l.createBlock)(h,{key:1,label:"其他参数",lazy:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(V,{column:1,border:"",size:"small"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.data,((e,t)=>((0,l.openBlock)(),(0,l.createBlock)(x,{key:t,label:t},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e),1)])),_:2},1032,["label"])))),128))])),_:1})])),_:1})):(0,l.createCommentVNode)("",!0)])),_:3})])),[[b,r.downLoading]])])),_:3})])),_:3},8,["modelValue"])],64)}function H(e,t,o,a,r,i){const n=(0,l.resolveComponent)("el-icon-d-caret"),d=(0,l.resolveComponent)("el-icon"),c=(0,l.resolveComponent)("el-tag"),s=(0,l.resolveComponent)("el-table-column"),p=(0,l.resolveComponent)("el-switch"),m=(0,l.resolveComponent)("el-table");return(0,l.openBlock)(),(0,l.createBlock)(m,{ref:"table",data:r.columnData,"row-key":"prop",style:{width:"100%"},border:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{prop:"",label:"排序",width:"60"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{class:"move",style:{cursor:"move"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(d,{style:{cursor:"move"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(n)])),_:1})])),_:1})])),_:1}),(0,l.createVNode)(s,{prop:"label",label:"列名"},{default:(0,l.withCtx)((e=>[(0,l.createVNode)(c,{round:"",effect:e.row.hide?"light":"dark",type:e.row.hide?"info":""},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.row.label),1)])),_:2},1032,["effect","type"])])),_:1}),(0,l.createVNode)(s,{prop:"hide",label:"显示",width:"60"},{default:(0,l.withCtx)((e=>[(0,l.createVNode)(p,{modelValue:e.row.hide,"onUpdate:modelValue":t=>e.row.hide=t,size:"small","active-value":!1,"inactive-value":!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"])}var K=o(51474),W={emits:["success"],props:{column:{type:Array,default:()=>[]}},data(){return{columnData:this.column}},mounted(){this.rowDrop()},methods:{rowDrop(){const e=this,t=this.$refs.table.$el.querySelector(".el-table__body-wrapper tbody");K.ZP.create(t,{handle:".move",animation:200,ghostClass:"ghost",onEnd({newIndex:t,oldIndex:o}){const l=e.columnData,a=l.splice(o,1)[0];l.splice(t,0,a)}})}}};const X=(0,I.Z)(W,[["render",H]]);var Y=X,ee={components:{columnSet:Y},props:{apiObj:{type:Object,default:()=>{}},fileName:{type:String,default:""},fileTypes:{type:Array,default:()=>["xlsx"]},data:{type:Object,default:()=>{}},showData:{type:Boolean,default:!1},async:{type:Boolean,default:!1},column:{type:Array,default:()=>[]},blob:{type:Boolean,default:!1},progress:{type:Boolean,default:!0}},data(){return{dialog:!1,formData:{fileName:this.fileName,fileType:this.fileTypes[0]},columnData:[],downLoading:!1,downLoadProgress:0,asyncLoading:!1}},watch:{"formData.fileType"(e){this.formData.fileName.includes(".")?this.formData.fileName=this.formData.fileName.substring(0,this.formData.fileName.lastIndexOf("."))+"."+e:this.formData.fileName=this.formData.fileName+"."+e}},mounted(){},methods:{open(){this.dialog=!0,this.formData={fileName:(this.fileName?this.fileName:(new Date).getTime()+"")+"."+this.fileTypes[0],fileType:this.fileTypes[0]},this.columnData=JSON.parse(JSON.stringify(this.column))},close(){this.dialog=!1},download(){let e={column:this.columnData.filter((e=>!e.hide)).map((e=>e.prop)).join(",")},t={...this.data,...this.formData,...e};this.async?this.asyncDownload(this.apiObj,this.formData.fileName,t):this.blob?this.downloadFile(this.apiObj,this.formData.fileName,t):this.linkFile(this.apiObj.url,this.formData.fileName,t)},linkFile(e,t,o={}){let l=document.createElement("a");l.style="display: none",l.target="_blank",l.href=e+this.toQueryString(o),document.body.appendChild(l),l.click(),document.body.removeChild(l)},downloadFile(e,t,o={}){this.downLoading=!0;var l=this;e.get(o,{responseType:"blob",onDownloadProgress(e){e.lengthComputable&&(l.downLoadProgress=parseInt(e.loaded/e.total*100))}}).then((e=>{this.downLoading=!1,this.downLoadProgress=0;let o=URL.createObjectURL(e),l=document.createElement("a");l.style="display: none",l.target="_blank",l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)})).catch((e=>{this.downLoading=!1,this.downLoadProgress=0,this.$notify.error({title:"下载文件失败",message:e})}))},asyncDownload(e,t,o={}){this.asyncLoading=!0,e.get(o).then((e=>{this.asyncLoading=!1,200==e.code?(this.dialog=!1,this.$msgbox({title:"成功发起任务",message:'<div><img style="height:200px" src="img/tasks-example.png"/></div><p>已成功发起导出任务，您可以操作其他事务</p><p>稍后可在 <b>任务中心</b> 查看执行结果</p>',type:"success",confirmButtonText:"知道了",dangerouslyUseHTMLString:!0,center:!0}).catch((()=>{}))):this.$alert(e.message||"未知错误","发起任务失败",{type:"error",center:!0}).catch((()=>{}))})).catch((()=>{this.asyncLoading=!1}))},toQueryString(e){let t=[];for(var o in e)t.push(`${o}=${e[o]}`);return(t.length>0?"?":"")+t.join("&")}}};const te=(0,I.Z)(ee,[["render",G]]);var oe=te,le={name:"importexport",components:{scFileImport:M,scFileExport:oe},data(){return{importErrDialogVisible:!1,importErrData:{},column:[{label:"姓名",prop:"name"},{label:"性别",prop:"sex"},{label:"评分",prop:"num"},{label:"邮箱",prop:"email",hide:!0},{label:"进度",prop:"progress"},{label:"注册时间",prop:"datetime"}]}},mounted(){},methods:{success(e,t){200==e.code?(this.$alert("导入返回成功后，可后续操作，比如刷新表格等。执行回调函数close()可关闭上传窗口。","导入成功",{type:"success",showClose:!1,center:!0}),t()):(this.importErrDialogVisible=!0,this.importErrData=e.data)}}};const ae=(0,I.Z)(le,[["render",j]]);var re=ae}}]);